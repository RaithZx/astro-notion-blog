---
import { getPageLink } from '../lib/blog-helpers.ts'

export interface Props {
  currentPage: number
  numberOfPages: number
  tag: string
}

const { currentPage, numberOfPages, tag = '' } = Astro.props

const isFirstPage = currentPage === 1
const isLastPage = currentPage === numberOfPages

const startPage = currentPage - 2 < 1 ? 1 : currentPage - 2
const endPage =
  currentPage + 2 > numberOfPages ? numberOfPages : currentPage + 2

let pages = []
for (let i = startPage; i <= endPage; i++) {
  pages.push(i)
}
---

<nav class="pagination" aria-label="Pagination Navigation">
  <div class="pagination-info">
    <span class="pagination-text">
      Págin {currentPage} di {numberOfPages}
    </span>
  </div>
  
  <div class="pagination-controls">
    <a 
      href={getPageLink(Math.max(1, currentPage - 1), tag)} 
      class={`pagination-btn pagination-prev ${isFirstPage ? 'disabled' : ''}`}
      aria-label="Págin anterior"
      aria-disabled={isFirstPage}
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
      <span class="pagination-btn-text">Anterior</span>
    </a>
    
    <div class="pagination-numbers">
      {!isFirstPage && startPage > 1 && (
        <>
          <a href={getPageLink(1, tag)} class="pagination-number">1</a>
          {startPage > 2 && <span class="pagination-ellipsis">...</span>}
        </>
      )}
      {
        pages.map((p: number) => (
          <a 
            href={getPageLink(p, tag)} 
            class={`pagination-number ${p === currentPage ? 'active' : ''}`}
            aria-label={`Págin ${p}`}
            aria-current={p === currentPage ? 'page' : undefined}
          >
            {p}
          </a>
        ))
      }
      {!isLastPage && endPage < numberOfPages && (
        <>
          {endPage < numberOfPages - 1 && <span class="pagination-ellipsis">...</span>}
          <a href={getPageLink(numberOfPages, tag)} class="pagination-number">{numberOfPages}</a>
        </>
      )}
    </div>
    
    <a 
      href={getPageLink(Math.min(numberOfPages, currentPage + 1), tag)} 
      class={`pagination-btn pagination-next ${isLastPage ? 'disabled' : ''}`}
      aria-label="Próximu págin"
      aria-disabled={isLastPage}
    >
      <span class="pagination-btn-text">Próximu</span>
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </a>
  </div>
</nav>

<style>
  .pagination {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    width: 100%;
    margin: 2rem auto;
    padding: 1.5rem 0;
  }

  .pagination-info {
    text-align: center;
  }

  .pagination-text {
    color: #64748b;
    font-size: 0.875rem;
    font-weight: 500;
  }

  .pagination-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .pagination-numbers {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .pagination-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    min-height: 2.75rem;
    border-radius: 0.5rem;
    background-color: white;
    color: #334155;
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
    cursor: pointer;
  }

  .pagination-btn:hover:not(.disabled) {
    background-color: #f1f5f9;
    border-color: #cbd5e1;
    color: #1e293b;
    transform: translateY(-1px);
  }

  .pagination-btn:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
  }

  .pagination-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  .pagination-btn svg {
    flex-shrink: 0;
  }

  .pagination-btn-text {
    display: none;
  }

  @media (min-width: 640px) {
    .pagination-btn-text {
      display: inline;
    }
  }

  .pagination-number {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 2.75rem;
    height: 2.75rem;
    padding: 0 0.75rem;
    border-radius: 0.5rem;
    background-color: white;
    color: #334155;
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
  }

  .pagination-number:hover {
    background-color: #f1f5f9;
    border-color: #cbd5e1;
    color: #1e293b;
  }

  .pagination-number.active {
    background-color: #3b82f6;
    border-color: #3b82f6;
    color: white;
    font-weight: 600;
  }

  .pagination-number.active:hover {
    background-color: #2563eb;
    border-color: #2563eb;
  }

  .pagination-number:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
  }

  .pagination-ellipsis {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 2.75rem;
    height: 2.75rem;
    color: #94a3b8;
    font-size: 0.875rem;
  }

  @media (max-width: 640px) {
    .pagination {
      margin: 1.5rem auto;
      padding: 1rem 0;
    }

    .pagination-controls {
      gap: 0.25rem;
    }

    .pagination-number {
      min-width: 2.5rem;
      height: 2.5rem;
      padding: 0 0.5rem;
      font-size: 0.8125rem;
    }

    .pagination-btn {
      min-height: 2.5rem;
      padding: 0.5rem 0.75rem;
      font-size: 0.8125rem;
    }
  }
</style>
